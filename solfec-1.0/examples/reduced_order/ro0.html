
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Rotating bar &#8212; PARMES  documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/parmes.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Pipe impact" href="ro1.html" />
    <link rel="prev" title="Reduced order modeling" href="../reduced_order.html" />
  
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  
  <link rel="alternate" type="application/atom+xml"  href="../../../blog/atom.xml" title="PARMES/blog">
  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="rotating-bar">
<span id="solfec-examples-reduced-order-ro0"></span><h1>Rotating bar<a class="headerlink" href="#rotating-bar" title="Permalink to this headline">¶</a></h1>
<p>This is a simplest application of the reduced order modeling functionality. This example is also included in <a class="reference internal" href="../../../trs/index.html#tr1"><span class="std std-ref">TR1</span></a>:
having a look into this technical report may be helpful. The input files for this example are located in the
<a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/reduced-order0">solfec-1.0/examples/reduced–order0</a> directory.
These are:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/README">README</a> – a text based specification of the problem</li>
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-convtest.py">ro0–convtest.py</a> – convergence test runs and plotting</li>
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-elong.py">ro0–elong.py</a> – elongation test runs and time history plotting</li>
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-energy.py">ro0–energy.py</a> – energy balance test runs and time history plotting</li>
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-gen-bases.py">ro0–gen–bases.py</a> – calculation of a reduced
<a class="reference external" href="https://en.wikipedia.org/wiki/Principal_component_analysis">POD</a> base</li>
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-lib.py">ro0–lib.py</a> – library functions used by other input files</li>
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-run-all.py">ro0–run–all.py</a> – input file that runs all tests and generates all plots</li>
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-view.py">ro0–view.py</a> – input file suitable for use with Solfec-1.0 <a class="reference internal" href="../../running.html#solfec-running"><span class="std std-ref">viewer</span></a></li>
</ul>
<div class="figure align-center" id="id13">
<span id="ro0-fig1"></span><a class="reference internal image-reference" href="../../../_images/ro0_mesh.png"><img alt="../../../_images/ro0_mesh.png" src="../../../_images/ro0_mesh.png" style="width: 20%;" /></a>
<p class="caption"><span class="caption-number">Fig. 60 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/reduced-order0">reduced-order0</a>: geometry of the <span class="math notranslate nohighlight">\(2\times2\times20\)</span> mesh.</span></p>
</div>
<p>A prismatic bar with <span class="math notranslate nohighlight">\(x,y,z\)</span> dimensions <span class="math notranslate nohighlight">\(0.1\times0.1\times1\mbox{ m}\)</span> and material parameters
<span class="math notranslate nohighlight">\(E\in\left\{ 200\mbox{E4 Pa},200\mbox{E9 Pa}\right\}\)</span>, <span class="math notranslate nohighlight">\(\nu=0.26,\rho=7.8\mbox{E3 kg /}\mbox{m}^{3}\)</span>
is rotating about the <span class="math notranslate nohighlight">\(x\)</span>–axis with an initial angular velocity of <span class="math notranslate nohighlight">\(1\mbox{ rad/s}\)</span>. We use the
smaller Young’s modulus in most demonstrations since in this case the time scales of the rigid and deformable
motions are not far apart. For <span class="math notranslate nohighlight">\(E=200\mbox{E9 Pa}\)</span> the material parameters correspond to steel. In this
case the time scale of elastic deformations is much faster then that of the rigid rotation. We use this material
to test performance of the proposed integrators when applied with large time steps. In what follows, unless stated
otherwise, the value <span class="math notranslate nohighlight">\(E=200\mbox{E4}\)</span> is used by default.</p>
<table class="docutils footnote" frame="void" id="id1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id11">2</a>)</em> An animation of the <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/reduced-order0">reduced-order0</a> rotating bar example.</td></tr>
</tbody>
</table>
<p align="center"><iframe width="648" height="364" src="//www.youtube.com/embed/c136dWHwWNU?rel=0" frameborder="0" allowfullscreen="1">&nbsp;</iframe></p><p>The bar is discretized with <span class="math notranslate nohighlight">\(2\times2\times20\)</span> fully integrated trilinear hexahedral elements, <a class="reference internal" href="#ro0-fig1"><span class="std std-numref">Fig. 60</span></a>
and animation <a class="footnote-reference" href="#id1" id="id2">[1]</a>. This results in 576 degrees of freedom for the full order model. For the reduced order
BC–RO approach we used 100 co–rotated displacement samples from the Total Lagrangian solution (with rigid rotation
factored out) and 6 rigid motion modes (generated algebraically) as input for the <a class="reference external" href="http://pythonhosted.org/modred">Python modred package</a>
and calculated 11 Proper Orthogonal Decomposition modes. In the current example, we also include the BC–MODAL approach,
for which the 6 rigid modes where combined with deformable modes 14, 19, 26, 34, 39 (of the initial linearized system), picked by hand
as visually corresponding to the predominantly longitudinal deformation of the bar. Hence, the BC–MODAL case also had 11 degrees of freedom.</p>
<div class="figure align-center" id="id14">
<span id="ro0-fig2"></span><a class="reference internal image-reference" href="../../../_images/ro0_elongation_d0.png"><img alt="../../../_images/ro0_elongation_d0.png" src="../../../_images/ro0_elongation_d0.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 61 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/reduced-order0">reduced-order0</a>: time history of the elongation for <span class="math notranslate nohighlight">\(h\in\left\{ 1/64\mbox{s},1/256\mbox{s}\right\}\)</span> and <span class="math notranslate nohighlight">\(1\mbox{s}\)</span> runs.</span></p>
</div>
<div class="figure align-center" id="id15">
<span id="ro0-fig3"></span><a class="reference internal image-reference" href="../../../_images/ro0_elongation_d0.05.png"><img alt="../../../_images/ro0_elongation_d0.05.png" src="../../../_images/ro0_elongation_d0.05.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 62 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/reduced-order0">reduced-order0</a>: time history of the elongation for <span class="math notranslate nohighlight">\(h=1/64\mbox{s}, \eta\in\left\{ 0.01,0.05\right\}\)</span> and <span class="math notranslate nohighlight">\(1\mbox{s}\)</span> runs.</span></p>
</div>
<p>We first compare the solutions for damped and undamped cases. <a class="reference internal" href="#ro0-fig2"><span class="std std-numref">Fig. 61</span></a> illustrates the time history of the elongation
of the bar, measured between the top and bottom center nodes, for undamped <span class="math notranslate nohighlight">\(1\mbox{s}\)</span> runs with time steps
<span class="math notranslate nohighlight">\(h\in\left\{ 1/64\mbox{s},1/256\mbox{s}\right\}\)</span>. It can be seen that the results compare well between the formulations
proposed here and the Total Lagrangian approach integrated in an analogous manner. A damped case is illustrated in <a class="reference internal" href="#ro0-fig3"><span class="std std-numref">Fig. 62</span></a>
for the large time step of <span class="math notranslate nohighlight">\(h=1/64\mbox{s}\)</span>. Also in this case the agreement is good. The Total Lagrangian based solution
deviates from the co–rotational solution since for the TL the stiffness matrix magnitude changes with configuration, which affects
the stiffness proportional damping. We can conclude the 5 deformable modes used by the BC–RO and BC–MODAL approaches represent
well the longitudinal oscillation accompanying the rotational motion of the bar.</p>
<div class="literal-block-wrapper docutils container" id="ro0-lst1">
<div class="code-block-caption"><span class="caption-number">Listing 6 </span><span class="caption-text">Listing of a portion of ro0–elong.py responsible for creation of <a class="reference internal" href="#ro0-fig2"><span class="std std-numref">Fig. 61</span></a></span><a class="headerlink" href="#ro0-lst1" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  <span class="n">execfile</span> <span class="p">(</span><span class="n">dirpath</span> <span class="o">+</span> <span class="s1">&#39;/ro0-gen-bases.py&#39;</span><span class="p">)</span>
  <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
  <span class="n">ro0_path_extension</span> <span class="p">(</span><span class="s1">&#39;-elong&#39;</span><span class="p">)</span>
  <span class="nb">print</span> <span class="s1">&#39;================&#39;</span>
  <span class="nb">print</span> <span class="s1">&#39;Elongation plots&#39;</span>
  <span class="nb">print</span> <span class="s1">&#39;================&#39;</span>
  <span class="c1"># Plot bar elongation history for:</span>
  <span class="c1"># - all schemes</span>
  <span class="c1"># - steps 1/64s and 1/256s</span>
  <span class="c1"># - damping 0.0</span>
  <span class="n">step_denom</span> <span class="o">=</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">256</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">div</span> <span class="ow">in</span> <span class="n">step_denom</span><span class="p">:</span>
    <span class="nb">print</span> <span class="s1">&#39;Solving for step 1/</span><span class="si">%d</span><span class="s1"> and damping 0.0 ...&#39;</span> <span class="o">%</span> <span class="n">div</span>
    <span class="nb">print</span> <span class="s1">&#39;FEM-TL ...&#39;</span><span class="p">,</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">ro0_model</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;TL&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="s1">&#39;%</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
		     <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">runduration</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s1">&#39;</span><span class="se">\b</span><span class="s1">FEM-BC ...&#39;</span><span class="p">,</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">ro0_model</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;BC&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="s1">&#39;%</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
		     <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">runduration</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s1">&#39;</span><span class="se">\b</span><span class="s1">FEM-BC-RO ...&#39;</span><span class="p">,</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">ro0_model</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;BC-RO&#39;</span><span class="p">,</span> <span class="n">pod_base</span><span class="p">,</span>
	<span class="n">verbose</span><span class="o">=</span><span class="s1">&#39;%</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">runduration</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s1">&#39;</span><span class="se">\b</span><span class="s1">FEM-BC-MODAL ...&#39;</span><span class="p">,</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">ro0_model</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;BC-MODAL&#39;</span><span class="p">,</span> <span class="n">modal_base</span><span class="p">,</span>
	    <span class="n">verbose</span><span class="o">=</span><span class="s1">&#39;%</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">runduration</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># open in &#39;READ&#39; mode and retrieve time histories</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">ro0_times</span> <span class="p">(</span><span class="n">ro0_model</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;TL&#39;</span><span class="p">))</span>
    <span class="n">l_tl</span> <span class="o">=</span> <span class="n">ro0_elongation</span> <span class="p">(</span><span class="n">ro0_model</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;TL&#39;</span><span class="p">))</span>
    <span class="n">l_bc</span> <span class="o">=</span> <span class="n">ro0_elongation</span> <span class="p">(</span><span class="n">ro0_model</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;BC&#39;</span><span class="p">))</span>
    <span class="n">l_bc_ro</span> <span class="o">=</span> <span class="n">ro0_elongation</span> <span class="p">(</span><span class="n">ro0_model</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
                                         <span class="s1">&#39;BC-RO&#39;</span><span class="p">,</span> <span class="n">pod_base</span><span class="p">))</span>
    <span class="n">l_bc_modal</span> <span class="o">=</span> <span class="n">ro0_elongation</span> <span class="p">(</span><span class="n">ro0_model</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
                                    <span class="s1">&#39;BC-MODAL&#39;</span><span class="p">,</span> <span class="n">modal_base</span><span class="p">))</span>

    <span class="nb">print</span> <span class="s1">&#39;</span><span class="se">\b</span><span class="s1">Plotting elongation history h=1/</span><span class="si">%d</span><span class="s1">, eta=0.0 ...&#39;</span> <span class="o">%</span> <span class="n">div</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span> <span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span> <span class="p">(</span><span class="s1">&#39;Rotating bar: elongation ($h = 1/</span><span class="si">%d</span><span class="s1">, \eta = 0.0$)&#39;</span> <span class="o">%</span> <span class="n">div</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span> <span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">l_tl</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;TL&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span> <span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">l_bc</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;BC&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span> <span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">l_bc_ro</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;BC-RO&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span> <span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">l_bc_modal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;BC-MODAL&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span> <span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span> <span class="p">(</span><span class="s1">&#39;Elongation [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span> <span class="p">(</span><span class="s1">&#39;out/reduced-order0/ro0_elongation_h</span><span class="si">%d</span><span class="s1">_d0.png&#39;</span> <span class="o">%</span> <span class="n">div</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<p>Looking at the input code that helped to generate the above results, we can start with file
<a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-elong.py">ro0–elong.py</a>. <a class="reference internal" href="#ro0-lst1"><span class="std std-numref">Listing 6</span></a>
includes a portion of this file responsible for generating <a class="reference internal" href="#ro0-fig2"><span class="std std-numref">Fig. 61</span></a>. In line 9 we execute the
<a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-gen-bases.py">ro0–gen–bases.py</a> file
which generates reduced order and modal bases variables <code class="docutils literal notranslate"><span class="pre">pod_base</span></code> and <code class="docutils literal notranslate"><span class="pre">modal_base</span></code>, used in lines  40 and 42.
We then use a library routine <a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-lib.py#L9">ro0_path_extension</a>
to include into the output directory path an extension specific to the elongation history tests. All library <code class="docutils literal notranslate"><span class="pre">ro0_*</span></code> subroutines are included in
<a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-lib.py">ro0–lib.py</a> file, executed at the start,
not shown here. In line 20 we start a loop over two time steps: 1/64s and 1/256s. For each time step, we run 1.0s long simulations
using <code class="docutils literal notranslate"><span class="pre">'TL'</span></code>, <code class="docutils literal notranslate"><span class="pre">'BC'</span></code>, <code class="docutils literal notranslate"><span class="pre">'BC-RO</span></code>, <code class="docutils literal notranslate"><span class="pre">'BC-MODAL'</span></code> formulations, in lines 23–33, and then read the resulting time histories
in lines 36–42. The <a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-lib.py#L14">ro0_model</a> function
creates a rotating bar model, runs the analysis, or reads the results, depending on parameters.
The <a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-lib.py#L180">ro0_times</a> function returners
the time history of time itself. The <a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-lib.py#L186">ro0_elongation</a>
function reads and returns the time history of bar elongation, given a <a class="reference internal" href="../../user/solfec.html#solfec-user-solfec"><span class="std std-ref">SOLFEC object</span></a> in <code class="docutils literal notranslate"><span class="pre">'READ'</span></code> mode as an input.
Finally, in lines 44–55, we use <a class="reference external" href="https://matplotlib.org">matplotlib</a> to generate figures that contribute to <a class="reference internal" href="#ro0-fig2"><span class="std std-numref">Fig. 61</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="ro0-lst2">
<div class="code-block-caption"><span class="caption-number">Listing 7 </span><span class="caption-text">Listing of ro0–gen–bases.py</span><a class="headerlink" href="#ro0-lst2" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># import model library routines</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">dirpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="n">execfile</span> <span class="p">(</span><span class="n">dirpath</span> <span class="o">+</span> <span class="s1">&#39;/ro0-lib.py&#39;</span><span class="p">)</span>

<span class="c1"># Initialise POD and modal bases</span>
<span class="k">try</span><span class="p">:</span>
  <span class="kn">import</span> <span class="nn">pickle</span>
  <span class="n">pod_base</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;out/reduced-order0/pod_base.pickle&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">))</span>
  <span class="n">modal_base</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;out/reduced-order0/modal_base.pickle&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">))</span>
<span class="k">except</span><span class="p">:</span>
  <span class="n">ro0_path_extension</span> <span class="p">(</span><span class="s1">&#39;-init&#39;</span><span class="p">)</span>
  <span class="nb">print</span> <span class="s1">&#39;==============&#39;</span>
  <span class="nb">print</span> <span class="s1">&#39;Initialization&#39;</span>
  <span class="nb">print</span> <span class="s1">&#39;==============&#39;</span>
  <span class="n">sol</span> <span class="o">=</span> <span class="n">ro0_model</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mi">256</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;TL&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="s1">&#39;%</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="nb">print</span> <span class="s1">&#39;Samping displacements ...&#39;</span><span class="p">,</span>
  <span class="n">rig</span> <span class="o">=</span> <span class="n">RIGID_DISPLACEMENTS</span> <span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">bodies</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
  <span class="n">defo</span> <span class="o">=</span> <span class="n">COROTATED_DISPLACEMENTS</span> <span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">bodies</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
  <span class="n">RUN</span> <span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="n">NEWTON_SOLVER</span><span class="p">(),</span> <span class="mf">1.0</span><span class="p">)</span>
  <span class="nb">print</span> <span class="s1">&#39;</span><span class="se">\b</span><span class="s1">Calculating POD base ...&#39;</span>
  <span class="n">pod_base</span> <span class="o">=</span> <span class="n">ro0_POD_base</span> <span class="p">(</span><span class="n">rig</span><span class="p">,</span> <span class="n">defo</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="nb">print</span> <span class="s1">&#39;Calculating modal base ...&#39;</span>
  <span class="n">modal_base</span> <span class="o">=</span> <span class="n">ro0_modal_base</span> <span class="p">()</span>

  <span class="c1"># Save POD and modal bases</span>
  <span class="kn">import</span> <span class="nn">pickle</span>
  <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">pod_base</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;out/reduced-order0/pod_base.pickle&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">))</span> 
  <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">modal_base</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;out/reduced-order0/modal_base.pickle&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">))</span> 
</pre></div>
</td></tr></table></div>
</div>
<p><a class="reference internal" href="#ro0-lst2"><span class="std std-numref">Listing 7</span></a> includes the <a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-gen-bases.py">ro0–gen–bases.py</a>
file. Because this code is used by multiple tests, in lines 9–10 we first attempt to read existing bases: one of the input files could have
been called already and those bases may have been saved. If this is not the case, in lines 12–29 we generate and save the reduced order
and modal bases. To generate the proper orthogonal decomposition reduced order base, we first create a Total Lagrangian model, in line 16,
but do not run it yet (the <code class="docutils literal notranslate"><span class="pre">runduration</span></code> parameter of <a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-lib.py#L14">ro0_model</a>
is not used). Instead, we used the <a class="reference internal" href="../../user/utilities.html#solfec-command-rigid-displacements"><span class="std std-ref">RIGID_DISPLACEMENTS</span></a>
and <a class="reference internal" href="../../user/utilities.html#solfec-command-corotated-displacements"><span class="std std-ref">COROTATED_DISPLACEMENTS</span></a> commands in order to sample rigid and co–rotated deformable displacements,
and then run the analysis in line 20. The rigid displacements <code class="docutils literal notranslate"><span class="pre">rig</span></code> and the sampled deformable displacements <code class="docutils literal notranslate"><span class="pre">defo</span></code> are then passed to the library
routine <a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-lib.py#L100">ro0_POD_base</a> which employs the <a class="reference external" href="https://pypi.python.org/pypi/modred">modred package</a> to calculate the reduced base. Following this, in line 24, the modal base is generated using library call
to <a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-lib.py#L69">ro0_modal_base</a>, which employs Solfec-1.0’s utility
function <a class="reference internal" href="../../user/utilities.html#solfec-command-modal-analysis"><span class="std std-ref">MODAL_ANALYSIS</span></a> in order to calculate the modal base.  Finally, the results are saved in lines 28 and 29.</p>
<div class="figure align-center" id="id16">
<span id="ro0-fig4"></span><a class="reference internal image-reference" href="../../../_images/ro0_energy_d0_100s.png"><img alt="../../../_images/ro0_energy_d0_100s.png" src="../../../_images/ro0_energy_d0_100s.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 63 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/reduced-order0">reduced-order0</a>: time history of total energy for <span class="math notranslate nohighlight">\(h\in\left\{ 1/64\mbox{s},1/256\mbox{s}\right\}\)</span>  and <span class="math notranslate nohighlight">\(100\mbox{s}\)</span> runs.</span></p>
</div>
<p><a class="reference internal" href="#ro0-fig4"><span class="std std-numref">Fig. 63</span></a> illustrates the time history of the total energy of the bar for 100s runs with time steps
<span class="math notranslate nohighlight">\(h\in\left\{ 1/64\mbox{s},1/256\mbox{s}\right\}\)</span>. For all but the BC–RO approach, the small oscillation of energy remains
bounded with time. The full space co–rotational BC approach is better behaved than BC–MODAL: in nearly coincides with the
Total Lagrangian approach. The relatively small oscillation of energy, present in TL, BC, and BC–MODAL cases, is characteristic
for the adopted time stepping and it has been also demonstrated <a class="footnote-reference" href="#id12" id="id8">[2]</a> on simpler model problems. The larger oscillation and dissipation
of energy, clear in case of the BC–RO approach, remains a shortcoming and it may be addressed in future revisions of <a class="reference internal" href="../../../trs/index.html#tr1"><span class="std std-ref">TR1</span></a>.
We note, that the <a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-energy.py">ro0–energy.py</a> input file
was used to generate <a class="reference internal" href="#ro0-fig4"><span class="std std-numref">Fig. 63</span></a>.</p>
<div class="figure align-center" id="id17">
<span id="ro0-fig5"></span><a class="reference internal image-reference" href="../../../_images/ro0_convtest.png"><img alt="../../../_images/ro0_convtest.png" src="../../../_images/ro0_convtest.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 64 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/reduced-order0">reduced-order0</a>: second order convergence of displacements for soft undamped (<span class="math notranslate nohighlight">\(E=200\mbox{E4, }\eta=0\)</span>) and
stiff damped (<span class="math notranslate nohighlight">\(E=200\mbox{E9, }\eta=1/10^{6}\)</span>) materials.</span></p>
</div>
<p>The second order convergence rate is illustrated in <a class="reference internal" href="#ro0-fig5"><span class="std std-numref">Fig. 64</span></a>. Two cases are considered: undamped motion
of a soft bar <span class="math notranslate nohighlight">\(E=200\mbox{E4}\)</span> and damped motion of stiff bar <span class="math notranslate nohighlight">\(E=200\mbox{E9}\)</span>. In both cases the
reference solution <span class="math notranslate nohighlight">\(q_{ref}\)</span> was obtained at time <span class="math notranslate nohighlight">\(t=1/2^{4}\mbox{s}\)</span> with time step <span class="math notranslate nohighlight">\(h=1/2^{16}\mbox{s}\)</span>.
For the softer material the time scales of the rigid and deformable motion are not far apart and hence it is easier
to observe the second order convergence for larger time steps. For the stiffer model we used damping <span class="math notranslate nohighlight">\(\eta=1/10^{6}\)</span>
in order to damp out the high frequency oscillations that could not be well represented for the large time steps used here.
<a class="reference internal" href="#ro0-fig5"><span class="std std-numref">Fig. 64</span></a> was generated using the
<a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/reduced-order0/ro0-convtest.py">ro0–convtest.py</a> input file.</p>
<p>To run this example and generate figures presented here, enter Solfec-1.0 source directory and type</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="n">reduced</span><span class="o">-</span><span class="n">order0</span><span class="o">/</span><span class="n">ro0</span><span class="o">-</span><span class="n">run</span><span class="o">-</span><span class="nb">all</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>After several minutes, when progress messages cease, figures are saved as <code class="docutils literal notranslate"><span class="pre">out/reduced-order0/*.png</span></code> files.
To interactively view the animated bar, as in video <a class="footnote-reference" href="#id1" id="id11">[1]</a>, call</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="o">-</span><span class="n">v</span> <span class="n">examples</span><span class="o">/</span><span class="n">reduced</span><span class="o">-</span><span class="n">order0</span><span class="o">/</span><span class="n">ro0</span><span class="o">-</span><span class="n">view</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>You can type <code class="docutils literal notranslate"><span class="pre">o</span></code> in order to highlight the output path in the viewer and see which model you are currently looking at.
You can switch between models using <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>. Right–click the mouse button to activate a drop–down menu and see
other available options and keyboard shortcuts.</p>
<table class="docutils footnote" frame="void" id="id12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[2]</a></td><td><a class="reference external" href="http://www.sciencedirect.com/science/article/pii/S0168927497000664">ANM, 25(2–3): 297–302, 1997.</a></td></tr>
</tbody>
</table>
</div>

  <div class="section">
  
  
  </div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">PARMES</a></h1>



<p class="blurb">Parallel mechanics and particulate media software blog</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=parmes&repo=parmes&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">SOLFEC-1.0</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../running.html">Running</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user.html">User Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../theory.html">Theory Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../validation.html">Validation Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../xdmf.html">XDMF export</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../applications.html">Applications</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../examples.html">Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../hybrid_modeling.html">Hybrid modeling</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../reduced_order.html">Reduced order modeling</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Rotating bar</a></li>
<li class="toctree-l4"><a class="reference internal" href="ro1.html">Pipe impact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../81array.html">81 bricks array</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../time_series.html">Time series</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference external" href="https://groups.google.com/forum/#!forum/solfec-1">Google group</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../dynlb/index.html">DYNLB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../parmec/index.html">PARMEC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../vbox/index.html">VBOX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tgz/index.html">TGZ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trs/index.html">TRs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../blog/about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contact.html">Contact</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">SOLFEC-1.0</a><ul>
  <li><a href="../../examples.html">Solfec-1.0 Examples</a><ul>
  <li><a href="../reduced_order.html">Reduced order modeling</a><ul>
      <li>Previous: <a href="../reduced_order.html" title="previous chapter">Reduced order modeling</a></li>
      <li>Next: <a href="ro1.html" title="next chapter">Pipe impact</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../../../blog.html">Recent Posts</a></h3>
  <ul>
    
    
      <li><a href="../../../blog/solfec_export_command.html">09 January - SOLFEC_EXPORT command</a></li>
    
      <li><a href="../../../blog/parmec_ball_joint.html">31 July - Parmec ball joint and articulated pendulum example</a></li>
    
      <li><a href="../../../blog/parmec_spherical_joint.html">13 June - Parmec spherical joint</a></li>
    
      <li><a href="../../../blog/parmec_spring_contact.html">23 May - Parmec spring contact</a></li>
    
      <li><a href="../../../blog/spring_curve_tests.html">07 March - Parmec spring curve tests</a></li>
    
  </ul>

  <h3><a href="../../../blog/tag.html">Tags</a></h3>
  <style type="text/css">
    ul.ablog-cloud {list-style: none; overflow: auto;}
    ul.ablog-cloud li {float: left; height: 20pt; line-height: 18pt; margin-right: 5px;}
    ul.ablog-cloud a {text-decoration: none; vertical-align: middle;}
    li.ablog-cloud-1{font-size: 80%;}
    li.ablog-cloud-2{font-size: 95%;}
    li.ablog-cloud-3{font-size: 110%;}
    li.ablog-cloud-4{font-size: 125%;}
    li.ablog-cloud-5{font-size: 140%;}
  </style>
  <ul class="ablog-cloud">
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../../blog/tag/algebraic.html">algebraic</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../../blog/tag/contact.html">contact</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../../blog/tag/failure.html">failure</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../../blog/tag/friction.html">friction</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../../blog/tag/joints.html">joints</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../../blog/tag/optimization.html">optimization</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-5">
        <a href="../../../blog/tag/parmec.html">parmec</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../../blog/tag/parmes.html">parmes</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../../blog/tag/pendulum.html">pendulum</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../../blog/tag/performance.html">performance</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../../blog/tag/reports.html">reports</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-3">
        <a href="../../../blog/tag/solfec.html">solfec</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../../blog/tag/springs.html">springs</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../../../blog/tag/tests.html">tests</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../../blog/tag/torsion.html">torsion</a></li>
      
    
  </ul>

  <h3><a href="../../../blog/archive.html">Archives</a></h3>
  <ul>
  
    
    <li><a href="../../../blog/2019.html">2019 (1)</a></li>
    
  
    
    <li><a href="../../../blog/2018.html">2018 (5)</a></li>
    
  
    
    <li><a href="../../../blog/2017.html">2017 (4)</a></li>
    
  
    
    <li><a href="../../../blog/2016.html">2016 (1)</a></li>
    
  
  </ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019 PARMES team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.9</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="../../../_sources/solfec-1.0/examples/reduced_order/ro0.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>