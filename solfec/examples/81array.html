
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>81 bricks array &#8212; PARMES  documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/parmes.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Time series" href="time_series.html" />
    <link rel="prev" title="Pipe impact" href="reduced_order/ro1.html" />
  
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  
  <link rel="alternate" type="application/atom+xml"  href="../../blog/atom.xml" title="PARMES/blog">
  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="bricks-array">
<span id="solfec-examples-81array"></span><h1>81 bricks array<a class="headerlink" href="#bricks-array" title="Permalink to this headline">¶</a></h1>
<p>This is example illustrates multiple aspects of Solfec functionality and serves as a validation test. It is also included with <a class="reference internal" href="../../trs/index.html#tr1"><span class="std std-ref">TR1</span></a>.
The input files for this example are located in the <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/81array">solfec/examples/81array</a>
directory. These are:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/81array/README">README</a> – a text based summary of the problem</li>
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/81array/81array.py">81array.py</a> – array excitation analysis input file</li>
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/81array/81fbi.py">81fbi.py</a> – fuel brick impact test input file</li>
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/81array/81postp.py">81postp.py</a> – post–processing script for the 81array.py input deck</li>
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/81array/81array.inp">81array[*].inp files</a> – <a class="reference external" href="https://en.wikipedia.org/wiki/Abaqus">ABAQUS</a> input decks used by 81array.py</li>
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/81array/81fbi.inp">81fbi[*].inp files</a> – <a class="reference external" href="https://en.wikipedia.org/wiki/Abaqus">ABAQUS</a> input decks used by 81fbi.py</li>
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/81array">81array[*]base.pikle.gz files</a> – saved reduced
<a class="reference external" href="https://en.wikipedia.org/wiki/Principal_component_analysis">POD</a> base files used by 81array.py and 81fbi.py</li>
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/81array">FB[*].csv files</a> – experimental results curves used by 81postp.py</li>
<li><a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/81array">ts81.py.bz2 file</a> – compressed time history of a seisimic excitation signal used by 81array.py</li>
</ul>
<div class="figure align-center" id="id13">
<span id="array-fig1"></span><a class="reference internal image-reference" href="../../_images/81rig.png"><img alt="../../_images/81rig.png" src="../../_images/81rig.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-number">Fig. 71 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/81array">81array</a>: experimental setup of the experiment.</span></p>
</div>
<p>The experiment behind this example comes from the context of the civil nuclear power generation in the UK.
A series of dynamic tests were carried out by National Nuclear Corporation in 1985 as part of the seismic
endorsement of the Heysham II / Torness AGR <a class="footnote-reference" href="#id10" id="id3">[*]</a> core design. These tests used an array of 81 graphite bricks
as shown in <a class="reference internal" href="#array-fig1"><span class="std std-numref">Fig. 71</span></a>, consisting of alternating ‘fuel’ and ‘interstitial’ bricks. The array was
mounted in a rigid frame on a shaker table. The boundary frame was driven in the horizontal plane with synthesized
seismic or swept–sine input motions in either one or both axes simultaneously. Measurements were taken of the
resulting velocities of certain bricks in the array (determined from accelerometer data) and also of the forces
within the keying system (using load cells built into some components). Some details of the experimental setup
has been described in <a class="footnote-reference" href="#id11" id="id4">[1]</a> and <a class="footnote-reference" href="#id12" id="id5">[2]</a>. We note, that this example is also called the “81 bricks array”, or simply
the “81 array”, because the total number of unconstrained fuel and interstitial bricks is 81.</p>
<div class="figure align-center" id="id14">
<span id="array-fig2"></span><a class="reference internal image-reference" href="../../_images/81mesh.png"><img alt="../../_images/81mesh.png" src="../../_images/81mesh.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-number">Fig. 72 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/81array">81array</a>: meshed model (base mesh).</span></p>
</div>
<p>In the current demonstration we bypass many of the details of our mechanical model. The ultimate aim is modeling
the entire AGR core (<span class="math notranslate nohighlight">\(\sim5\text{K}\)</span> fuel bricks), hence we are in the search for the lowest possible resolution
model. We are going to demonstrate some results for two mesh densities: denoted as a “basic mesh” and a “fine mesh”,
cf. <a class="reference internal" href="#array-tab1"><span class="std std-numref">Table 32</span></a>. The basic meshed model is presented in <a class="reference internal" href="#array-fig2"><span class="std std-numref">Fig. 72</span></a>. As in the experiment all
bodies are vertically restrained so that they move in a frictionless manner in the horizontal plane. Since the behavior
of the assembly is essentially two dimensional the number of elements along the height is kept to minimum. In
<a class="reference internal" href="#array-fig3"><span class="std std-numref">Fig. 73</span></a> one can see that the number of elements used in the horizontal brick sections is also small.
For fuel brick meshes the error in the lowest eigenmodes corresponding to planar squeezing is below 35% (as compared
with finer meshes), which we tentatively accept in the quest for a lowest possible resolution model.</p>
<div class="figure align-center" id="id15">
<span id="array-fig3"></span><a class="reference internal image-reference" href="../../_images/81module_fbi.png"><img alt="../../_images/81module_fbi.png" src="../../_images/81module_fbi.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-number">Fig. 73 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/81array">81array</a>: array module closeup (left: base mesh) and the binary impact test (right: fine mesh).</span></p>
</div>
<span id="array-tab1"></span><table border="1" class="docutils" id="id16">
<caption><span class="caption-number">Table 32 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/81array">81array</a>: base and fine mesh statistics. There are 61 fuel bricks, 60 interstitial bricks, and 100 loose keys in each case.</span><a class="headerlink" href="#id16" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="14%" />
<col width="16%" />
<col width="7%" />
<col width="14%" />
<col width="23%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td colspan="3">&#160;</td>
<td>Fuel brick</td>
<td>Interstitial brick</td>
<td>Loose key</td>
<td>Model total</td>
</tr>
<tr class="row-even"><td rowspan="2">BC</td>
<td>base mesh</td>
<td rowspan="4">DOFs</td>
<td>432</td>
<td>456</td>
<td>24</td>
<td>56112</td>
</tr>
<tr class="row-odd"><td>fine mesh</td>
<td>1512</td>
<td>456</td>
<td>24</td>
<td>121992</td>
</tr>
<tr class="row-even"><td rowspan="2">BC–RO</td>
<td>base mesh</td>
<td>64</td>
<td>64</td>
<td>24</td>
<td>10144</td>
</tr>
<tr class="row-odd"><td>fine mesh</td>
<td>64</td>
<td>64</td>
<td>24</td>
<td>10144</td>
</tr>
</tbody>
</table>
<p>The following material parameters were assumed for the graphite used in the experiment: 1.18E10Pa for Young’s modulus,
0.21 for Poisson’s ratio, and for mass density 1688kg/<span class="math notranslate nohighlight">\(\mbox{m}^{3}\)</span>, 1637kg/<span class="math notranslate nohighlight">\(\mbox{m}^{3}\)</span>, 1740kg/<span class="math notranslate nohighlight">\(\mbox{m}^{3}\)</span>
for respectively fuel bricks, interstitial bricks and loose keys (the mass densities were tuned to obtain the total brick
weights reported in the experiment). The coefficient of Coulomb’s friction was assumed 0.1. Among several simple impact tests
performed in the preliminary experimental work, a binary impact between fuel bricks was <a class="reference internal" href="#array-fig3"><span class="std std-numref">Fig. 73</span></a> (right). A range
of relative input velocities was used (5–35 cm/s) for which the ratio of the output velocity to the input velocity remained
consistently in the area of 0.9. It should be noted that due to geometrical setup, this particular type of impact is not present
in our full array model. We then have two independent experiments, which we try to validate simultaneously.</p>
<p>We use three families of models: solely rigid (RG), body co-rotational (BC), and reduced order (BC–RO). In all cases
the time step is 0.0001s.  Co–rotated displacements from the BC simulation were sampled at 0.02s intervals and together
with the 6 algebraically generated rigid modes, for each distinct mesh instance, served as an input for the
<a class="reference external" href="http://pythonhosted.org/modred/">Python modred package</a>, to produce POD bases for the BC-RO approach: 64 modes were
used for both the fuel and the interstitial bricks. The loose keys were modeled as single elements based on the co–rotated
BC approach. For the deformable models we used damping <span class="math notranslate nohighlight">\(\eta=\mbox{1E-7}\)</span>, which, for the finer mesh, roughly reproduced
the required macroscopic velocity restitution of 0.9 for the binary impact test from <a class="reference internal" href="#array-fig1"><span class="std std-numref">Fig. 71</span></a> (right): restitution
of 0.91 was produced by the BC approach, and 0.86 by BC–RO. For the basic mesh, the reproduced coefficient of restitution was
0.85 for the BC approach, and 0.82 for BC–RO. In case of the rigid body model the impact restitution was zero, resulting in
a totally passive response.</p>
<p>In the initial validation of the entire array model we aimed at reproducing a swept–sine constant amplitude acceleration test.
In the experiment the array was subject to a 3s 3Hz settling dwell at start, followed by a 3Hz to 10Hz sweep with 0.1Hz/s buildup
rate and constant amplitude of 0.3g, all this amounting to the total duration of 72s. The sweep direction was aligned with one
of the sides of the array. Linear velocity histories of the centre points of several bricks were recorded at 50Hz. Magnitudes
of these velocities were then averaged using 0.1Hz window and plotted as time series normalized by the corresponding magnitudes
of the input velocity.</p>
<p>The input acceleration signal produces a smoothly decaying envelope of displacement, which given a fixed amount of clearance between
bricks, initially builds up their “rattling” interactions and then passes a threshold beyond which interactions cease. Initially
the displacements are much larger than the clearance and the entire array is swept back and forth. When the boundary displacements
reach the level of the clearance (few mm) the kinetic energy starts being injected into higher modes of the system. This builds up
a peak in the velocity response. When the input displacements fall below the clearance distance the bricks disengage and there is
a drop in the velocity response.</p>
<div class="figure align-center" id="id17">
<span id="array-fig4"></span><a class="reference internal image-reference" href="../../_images/81velo_BC.png"><img alt="../../_images/81velo_BC.png" src="../../_images/81velo_BC.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 74 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/81array">81array</a>: frequency histories of normalized output velocity magnitudes. EXP is the experiment.
BC–base and BC–fine denote the body co–rotational formulation using respectively the base and the fine mesh.</span></p>
</div>
<div class="figure align-center" id="id18">
<span id="array-fig5"></span><a class="reference internal image-reference" href="../../_images/81velo_RO.png"><img alt="../../_images/81velo_RO.png" src="../../_images/81velo_RO.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 75 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/81array">81array</a>: frequency histories of normalized output velocity magnitudes. EXP is the experiment.
RO–base and RO–fine denote the reduced order formulation using respectively the base and the fine mesh.</span></p>
</div>
<div class="figure align-center" id="id19">
<span id="array-fig6"></span><a class="reference internal image-reference" href="../../_images/81velo_BC_RO_base.png"><img alt="../../_images/81velo_BC_RO_base.png" src="../../_images/81velo_BC_RO_base.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 76 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/81array">81array</a>: frequency histories of normalized output velocity magnitudes. EXP is the experiment.
BC–base and RO–base are respectively the BC and the BC–RO formulations, both using the base mesh.</span></p>
</div>
<div class="figure align-center" id="id20">
<span id="array-fig7"></span><a class="reference internal image-reference" href="../../_images/81velo_BC_RO_fine.png"><img alt="../../_images/81velo_BC_RO_fine.png" src="../../_images/81velo_BC_RO_fine.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 77 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/81array">81array</a>: frequency histories of normalized output velocity magnitudes. EXP is the experiment.
BC–fine and RO–fine are respectively the BC and the BC–RO formulations, both using the fine mesh.</span></p>
</div>
<p><a class="reference internal" href="#array-fig4"><span class="std std-numref">Fig. 74</span></a> – <a class="reference internal" href="#array-fig7"><span class="std std-numref">Fig. 77</span></a> show time histories of normalized output velocity magnitudes for selected fuel
and interstitial bricks, compared with those obtained in the experiment. One can see that relatively good agreement is obtained
for all combinations of base and fine FE meshes combined with the body co–rotational (BC) and reduced order BC–RO (dented as RO
in the figures) formulations. The best overall match seems to be obtained in case of the BC–fine model: combining the body
co–rotational formulation (BC) and the fine mesh (where only the fuel bricks are refined). This is specifically visible in <a class="reference internal" href="#array-fig4"><span class="std std-numref">Fig. 74</span></a>
and <a class="reference internal" href="#array-fig7"><span class="std std-numref">Fig. 77</span></a> where the performance of the BC–fine model for the FB2(2)(2) fuel brick is better than of the BC–base
and RO–fine models. There seems to be some correlation between the ability to reproduce the 0.9 binary impact velocity restitution
from the experiment, and the ability to match most of the experimental curves in <a class="reference internal" href="#array-fig4"><span class="std std-numref">Fig. 74</span></a> – <a class="reference internal" href="#array-fig7"><span class="std std-numref">Fig. 77</span></a>.
On the other hand, <a class="reference internal" href="#array-fig8"><span class="std std-numref">Fig. 78</span></a> compares the performance of the BC–base approach with that of the purely rigid body model
(RG). Clearly, the rigid body approach is not able to reproduce the experimentally observed peaks.</p>
<div class="figure align-center" id="id21">
<span id="array-fig8"></span><a class="reference internal image-reference" href="../../_images/81velo_RG_BC.png"><img alt="../../_images/81velo_RG_BC.png" src="../../_images/81velo_RG_BC.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 78 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/81array">81array</a>: frequency histories of normalized output velocity magnitudes. EXP is the experiment.
RG and BC–base are respectively the rigid body and the body co–rotational formulations, both using the base mesh.</span></p>
</div>
<p>Statistics of total runtimes and average time shares of computational stages are included in <a class="reference internal" href="#array-tab2"><span class="std std-numref">Table 33</span></a>. These are
collected for BC–fine/base, RO–fine/base and the rigid body models, all run using 6 MPI ranks on a single compute node, equipped
with Intel Xeon E5–2600 processing units. There is some “give and take” happening in terms of the share of the computational time
taken by various operations. The time integration runtime, which is significant for the deformable models, for RO–fine/base is shorter
compared to the fully resolved BC–fine/base models. Assembling of constraint equations, which dominates the computational time, also
takes less time in case of RO–fine/base, when compared to BC-fine/base. In the deformable model cases contact solution does not dominate
the total runtime. This reversed in case of the solely rigid model, where solving the ill–conditioned constraint equations dominates.
<a class="reference internal" href="#array-tab3"><span class="std std-numref">Table 34</span></a> illustrates parallel scaling, from 3 to 24 MPI–ranks, on a 24 core cluster node equipped with two Intel Xeon
E5–2600 CPUs. Maximum speedups are 3.43/2.49 for the BC/RO–base models and 3.99/2.57 for the BC/RO–fine models. We note that currently
Solfec does not exploit shared memory parallelism. The domain decomposition based load balancing may not be a most suitable parallelization
strategy for a problem of this size, run on a single cluster node. <a class="reference internal" href="#array-tab4"><span class="std std-numref">Table 35</span></a> illustrates the size of the output storage for
the tested approaches. Naturally, the reduced order models output less, compared to the fully resolved models. Finally, video <a class="reference internal" href="#yt0" id="id6">[YT0]</a> shows
an animated output.</p>
<span id="array-tab2"></span><table border="1" class="docutils" id="id22">
<caption><span class="caption-number">Table 33 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/81array">81array</a>: comparison of runtimes, for various formulations, using 6 MPI ranks on a single Intel
         Xeon E5–2600 CPU based compute node.</span><a class="headerlink" href="#id22" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="7%" />
<col width="24%" />
<col width="13%" />
<col width="14%" />
<col width="13%" />
<col width="14%" />
<col width="15%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td colspan="2">Formulation</td>
<td>BC–fine</td>
<td>BC–base</td>
<td>RO–fine</td>
<td>RO–base</td>
<td>Rigid body</td>
</tr>
<tr class="row-even"><td rowspan="5">Comp.
stage
(h)</td>
<td>Time integration</td>
<td>4.6</td>
<td>2.1</td>
<td>3.4</td>
<td>1.7</td>
<td>0.1</td>
</tr>
<tr class="row-odd"><td>Contact detection</td>
<td>0.9</td>
<td>0.5</td>
<td>0.8</td>
<td>0.5</td>
<td>0.4</td>
</tr>
<tr class="row-even"><td>Constraints equations</td>
<td>13.7</td>
<td>5.7</td>
<td>4.0</td>
<td>2.9</td>
<td>0.2</td>
</tr>
<tr class="row-odd"><td>Constraints solution</td>
<td>0.7</td>
<td>0.9</td>
<td>1.2</td>
<td>1.3</td>
<td>3.4</td>
</tr>
<tr class="row-even"><td>Load balancing</td>
<td>1.3</td>
<td>0.7</td>
<td>1.0</td>
<td>0.7</td>
<td>0.3</td>
</tr>
<tr class="row-odd"><td colspan="2">Total runtime (h)</td>
<td>21.18</td>
<td>9.92</td>
<td>10.53</td>
<td>7.15</td>
<td>4.37</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<span id="array-tab3"></span><table border="1" class="docutils" id="id23">
<caption><span class="caption-number">Table 34 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/81array">81array</a>: comparison of runtime scaling, for various formulations, on a single Intel Xeon
         E5–2600 CPU based compute node. BC–base–72s and RO–base–72s used the base mesh and had 72s duration.
         BC–fine–7.2s and RO–fine–7.2s used the fine mesh and had a 10x shorter duration of 7.2s.</span><a class="headerlink" href="#id23" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="48%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>MPI ranks</td>
<td>3</td>
<td>6</td>
<td>12</td>
<td>24</td>
</tr>
<tr class="row-even"><td>BC–base–72s runtime (h)</td>
<td>17.81</td>
<td>9.92</td>
<td>6.90</td>
<td>5.20</td>
</tr>
<tr class="row-odd"><td>RO–base–72s runtime (h)</td>
<td>11.94</td>
<td>7.15</td>
<td>5.56</td>
<td>4.79</td>
</tr>
<tr class="row-even"><td>BC–fine–7.2s runtime (h)</td>
<td>4.31</td>
<td>2.31</td>
<td>1.52</td>
<td>1.08</td>
</tr>
<tr class="row-odd"><td>RO–fine–7.2s runtime (h)</td>
<td>2.03</td>
<td>1.19</td>
<td>0.97</td>
<td>0.79</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<span id="array-tab4"></span><table border="1" class="docutils" id="id24">
<caption><span class="caption-number">Table 35 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/81array">81array</a>: comparison of storage size, for various formulations, for the 72s long runs and using the 50Hz file output frequency.</span><a class="headerlink" href="#id24" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="17%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Formulation</td>
<td>BC–fine</td>
<td>BC–base</td>
<td>RO–fine</td>
<td>RO–base</td>
<td>Rigid body</td>
</tr>
<tr class="row-even"><td>Storage size</td>
<td>7.2GB</td>
<td>3.7GB</td>
<td>1.2GB</td>
<td>1.2GB</td>
<td>0.84GB</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<table class="docutils citation" frame="void" id="yt0" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[YT0]</a></td><td>An animation of the <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/81array">81array</a> example DX displacement time history.</td></tr>
</tbody>
</table>
<p align="center"><iframe width="648" height="364" src="//www.youtube.com/embed/oDxQesw2Jco?rel=0" frameborder="0" allowfullscreen="1">&nbsp;</iframe></p><div class="section" id="running-81-array">
<h2>Running 81 array<a class="headerlink" href="#running-81-array" title="Permalink to this headline">¶</a></h2>
<p>The 81 array example input file has several options. You can see them by invoking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">help</span>
</pre></div>
</div>
<p>which outputs</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">------------------------------------------------------------------------</span>
<span class="mi">81</span> <span class="n">array</span> <span class="n">example</span> <span class="n">parameters</span><span class="p">:</span>
<span class="o">------------------------------------------------------------------------</span>
<span class="o">-</span><span class="n">form</span> <span class="n">name</span> <span class="o">=&gt;</span> <span class="n">where</span> <span class="n">name</span> <span class="ow">is</span> <span class="n">TL</span><span class="p">,</span> <span class="n">BC</span><span class="p">,</span> <span class="n">RO</span><span class="p">,</span> <span class="n">MODAL</span><span class="p">,</span> <span class="n">PR</span> <span class="ow">or</span> <span class="n">RG</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="n">BC</span><span class="p">)</span>
<span class="o">-</span><span class="n">fbmod</span> <span class="n">num</span> <span class="o">=&gt;</span> <span class="n">fuel</span> <span class="n">brick</span> <span class="n">modes</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mi">64</span><span class="p">)</span>
<span class="o">-</span><span class="n">ibmod</span> <span class="n">num</span> <span class="o">=&gt;</span> <span class="n">interstitial</span> <span class="n">brick</span> <span class="n">modes</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mi">64</span><span class="p">)</span>
<span class="o">-</span><span class="n">afile</span> <span class="n">path</span> <span class="o">=&gt;</span> <span class="n">ABAQUS</span> <span class="mi">81</span> <span class="n">array</span> <span class="o">*.</span><span class="n">inp</span> <span class="n">file</span> <span class="n">path</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">inp</span><span class="p">)</span>
<span class="o">-</span><span class="n">step</span> <span class="n">num</span> <span class="o">=&gt;</span> <span class="n">time</span> <span class="n">step</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">)</span>
<span class="o">-</span><span class="n">damp</span> <span class="n">num</span> <span class="o">=&gt;</span> <span class="n">damping</span> <span class="n">value</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mf">1e-07</span><span class="p">)</span>
<span class="o">-</span><span class="n">rest</span> <span class="n">num</span> <span class="o">=&gt;</span> <span class="n">impact</span> <span class="n">restitution</span><span class="p">,</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">-</span><span class="n">outi</span> <span class="n">num</span> <span class="o">=&gt;</span> <span class="n">output</span> <span class="n">interval</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">)</span>
<span class="o">-</span><span class="n">stop</span> <span class="n">num</span> <span class="o">=&gt;</span> <span class="n">sumulation</span> <span class="n">end</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mf">72.0</span><span class="p">)</span>
<span class="o">-</span><span class="n">genbase</span> <span class="o">=&gt;</span> <span class="n">generate</span> <span class="n">RO</span> <span class="p">(</span><span class="n">read</span> <span class="n">mode</span><span class="p">)</span> <span class="ow">or</span> <span class="n">MODAL</span> <span class="p">(</span><span class="n">write</span> <span class="n">mode</span><span class="p">)</span> <span class="n">bases</span> <span class="ow">and</span> <span class="n">stop</span>
<span class="o">-</span><span class="n">help</span> <span class="o">=&gt;</span> <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="ow">and</span> <span class="n">exit</span>
<span class="o">------------------------------------------------------------------------</span>
</pre></div>
</div>
<p>The defaults are set up in such a way, that running</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>starts an analysis using the body co–rotational approach (BC) and the base mesh, <a class="reference internal" href="#array-fig2"><span class="std std-numref">Fig. 72</span></a>. A serial run like above
will take several days to complete. If possible, it may be beneficial to use a multi–core shared memory computer or a cluster and
run instead</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="n">N</span> <span class="n">solfec</span><span class="o">-</span><span class="n">mpi</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>where N is the number of MPI ranks – corresponding to the level of available physical parallalism. If you only want to test this
example on a serial computer, you may shorten the analysis, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">stop</span> <span class="mf">1.0</span>
</pre></div>
</div>
<p>which will only run 1s long simulation – and take 72x less time on average. To run the Total Lagrangian based analysis instead
add <code class="docutils literal notranslate"><span class="pre">-form</span> <span class="pre">TL</span></code> after <code class="docutils literal notranslate"><span class="pre">solfec</span></code> or <code class="docutils literal notranslate"><span class="pre">solfec-mpi</span></code> and run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="n">N</span> <span class="n">solfec</span><span class="o">-</span><span class="n">mpi</span> <span class="o">-</span><span class="n">form</span> <span class="n">TL</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Note, that the order of arguments after the Solfec command does not matter. This example comes equipped with reduced order bases
made of 64 modes for both fuel and interstitial bricks. These are saved as
<a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/81array">81array[*]base.pikle.gz files</a> files and they corepond to
<a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/81array/81array.inp">81array[*].inp files</a> input decks: <code class="docutils literal notranslate"><span class="pre">81array.inp</span></code>
(base mesh) and <code class="docutils literal notranslate"><span class="pre">81array_4_2.inp</span></code> (fine mesh). If you would like to generate your own reduced base, you first need to run BC–based
or a TL–based analysis. Once it has terminated, you then need to run it again, <strong>in serial mode</strong>, using the <code class="docutils literal notranslate"><span class="pre">-genbase</span></code> switch, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">genbase</span> <span class="o">-</span><span class="n">fbbod</span> <span class="mi">96</span> <span class="o">-</span><span class="n">ibmod</span> <span class="mi">32</span>
</pre></div>
</div>
<p>This will read the results and generate a reduced order base made of 96 modes for fuel bricks and 32 modes for interstitial bricks,
for the default body co–rotated finite element formulation employing the base mesh. Note, that this will also overwrite the default
bases stored in the <code class="docutils literal notranslate"><span class="pre">examples/81array</span></code> directory. You may want to make a copy of this directory when investigating various reduced
bases, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="o">-</span><span class="n">r</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="mi">81</span><span class="n">array_copy</span>
<span class="n">solfec</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="mi">81</span><span class="n">array_copy</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">genbase</span> <span class="o">-</span><span class="n">fbbod</span> <span class="mi">96</span> <span class="o">-</span><span class="n">ibmod</span> <span class="mi">32</span>
</pre></div>
</div>
<p>The output files are saved inside of <code class="docutils literal notranslate"><span class="pre">out/81array[*]</span></code> directories: what goes after the <code class="docutils literal notranslate"><span class="pre">81array</span></code> string depends on the paramters
used to run the analysis. E.g. the default parameters result in the following outout directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">out</span><span class="o">/</span><span class="mi">81</span><span class="n">array_BC_s1</span><span class="o">.</span><span class="mf">0e-04</span><span class="n">_d1</span><span class="o">.</span><span class="mf">0e-07</span><span class="n">_r0</span><span class="o">/</span>
</pre></div>
</div>
<p>meaning a BC–based analysis, 1E-4 time step, 1E-7 damping, and 0 restitution. The restitution coefficient here denotes the instantaneous
“Newton” impact restitution – it is generally unphysical to use it in muli–impact simulations – so it is here only for the sake of
experimenting. If you happened to use an output subdirectory by invoking the <code class="docutils literal notranslate"><span class="pre">[-s</span> <span class="pre">sub-directory]</span></code> Solfec command line switch, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="mi">24</span> <span class="n">solfec</span><span class="o">-</span><span class="n">mpi</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">s</span> <span class="n">BC24</span>
</pre></div>
</div>
<p>note that the output files will now be placed inside of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">out</span><span class="o">/</span><span class="mi">81</span><span class="n">array_BC_s1</span><span class="o">.</span><span class="mf">0e-04</span><span class="n">_d1</span><span class="o">.</span><span class="mf">0e-07</span><span class="n">_r0</span><span class="o">/</span><span class="n">BC24</span>
</pre></div>
</div>
<p>and in order to generate the reduced bases you will need to keep informing Solfec about this, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">genbase</span> <span class="o">-</span><span class="n">fbbod</span> <span class="mi">96</span> <span class="o">-</span><span class="n">ibmod</span> <span class="mi">32</span> <span class="o">-</span><span class="n">s</span> <span class="n">BC24</span>
</pre></div>
</div>
<p>This also applies to viewing the results, e.g. you can run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="o">-</span><span class="n">v</span>  <span class="o">-</span><span class="n">s</span> <span class="n">BC24</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>to view results from <code class="docutils literal notranslate"><span class="pre">out/81array_BC_s1.0e-04_d1.0e-07_r0/BC24</span></code> or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="o">-</span><span class="n">v</span>  <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>to view results from <code class="docutils literal notranslate"><span class="pre">out/81array_BC_s1.0e-04_d1.0e-07_r0</span></code>.</p>
<p>To run the BC–MODAL analysis (body co–rotational using modal base) you will first need to generate the modal bases. This is done
as follows</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">form</span> <span class="n">MODAL</span> <span class="o">-</span><span class="n">genbase</span>
</pre></div>
</div>
<p>which results in</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Saved</span> <span class="n">MODAL</span> <span class="n">base</span> <span class="k">as</span><span class="p">:</span> <span class="n">out</span><span class="o">/</span><span class="mi">81</span><span class="n">array_MODAL_FB64_IB64_s1</span><span class="o">.</span><span class="mf">0e-04</span><span class="n">_d1</span><span class="o">.</span><span class="mf">0e-07</span><span class="n">_r0</span><span class="o">/</span><span class="n">FB1_modalbase</span><span class="o">.</span><span class="n">h5</span>
<span class="n">Saved</span> <span class="n">MODAL</span> <span class="n">base</span> <span class="k">as</span><span class="p">:</span> <span class="n">out</span><span class="o">/</span><span class="mi">81</span><span class="n">array_MODAL_FB64_IB64_s1</span><span class="o">.</span><span class="mf">0e-04</span><span class="n">_d1</span><span class="o">.</span><span class="mf">0e-07</span><span class="n">_r0</span><span class="o">/</span><span class="n">FB2_modalbase</span><span class="o">.</span><span class="n">h5</span>
<span class="n">Saved</span> <span class="n">MODAL</span> <span class="n">base</span> <span class="k">as</span><span class="p">:</span> <span class="n">out</span><span class="o">/</span><span class="mi">81</span><span class="n">array_MODAL_FB64_IB64_s1</span><span class="o">.</span><span class="mf">0e-04</span><span class="n">_d1</span><span class="o">.</span><span class="mf">0e-07</span><span class="n">_r0</span><span class="o">/</span><span class="n">IB2_modalbase</span><span class="o">.</span><span class="n">h5</span>
<span class="n">Saved</span> <span class="n">MODAL</span> <span class="n">base</span> <span class="k">as</span><span class="p">:</span> <span class="n">out</span><span class="o">/</span><span class="mi">81</span><span class="n">array_MODAL_FB64_IB64_s1</span><span class="o">.</span><span class="mf">0e-04</span><span class="n">_d1</span><span class="o">.</span><span class="mf">0e-07</span><span class="n">_r0</span><span class="o">/</span><span class="n">IB1_modalbase</span><span class="o">.</span><span class="n">h5</span>
<span class="n">INFO</span><span class="p">:</span> <span class="o">-</span><span class="n">genbase</span> <span class="n">was</span> <span class="n">used</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">modal</span> <span class="n">bases</span> <span class="o">--&gt;</span> <span class="n">now</span> <span class="n">run</span> <span class="n">without</span> <span class="p">[</span><span class="o">-</span><span class="n">genbase</span><span class="p">];</span> <span class="n">exiting</span><span class="o">...</span>
</pre></div>
</div>
<p>You can then run the BC–MODAL analysis as hinted above</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="n">N</span> <span class="n">solfec</span><span class="o">-</span><span class="n">mpi</span> <span class="o">-</span><span class="n">form</span> <span class="n">MODAL</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>using the modal bases generated in the previous step.</p>
</div>
<div class="section" id="post-processing-81-array">
<h2>Post–processing 81 array<a class="headerlink" href="#post-processing-81-array" title="Permalink to this headline">¶</a></h2>
<p>Once you have run one or several 81 array analyses, you can generate figures, similar to <a class="reference internal" href="#array-fig4"><span class="std std-numref">Fig. 74</span></a> – <a class="reference internal" href="#array-fig8"><span class="std std-numref">Fig. 78</span></a>,
by a sequence of the following steps. First, post–process individual run results, by “run them again”, <strong>in serial mode</strong>, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>will post–process the default analysis results, provided that results are present in <code class="docutils literal notranslate"><span class="pre">out/81array_BC_s1.0e-04_d1.0e-07_r0</span></code>.
A single <strong>[*].thv file</strong> is generate per–analysis and output in the same directory as the remaing result files. We then use
the <a class="reference external" href="https://github.com/tkoziara/solfec/blob/master/examples/81array/81postp.py">81postp.py</a> script to genere figures similar
to <a class="reference internal" href="#array-fig4"><span class="std std-numref">Fig. 74</span></a>, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">postp</span><span class="o">.</span><span class="n">py</span> <span class="n">out</span><span class="o">/</span><span class="mi">81</span><span class="n">array_BC_s1</span><span class="o">.</span><span class="mf">0e-04</span><span class="n">_d1</span><span class="o">.</span><span class="mf">0e-07</span><span class="n">_r0</span><span class="o">/</span><span class="mi">81</span><span class="n">array_BC_s1</span><span class="o">.</span><span class="mf">0e-04</span><span class="n">_d1</span><span class="o">.</span><span class="mf">0e-07</span><span class="n">_r0</span><span class="o">.</span><span class="n">thv</span> <span class="n">BC</span>
</pre></div>
</div>
<p>generates a <code class="docutils literal notranslate"><span class="pre">81velo.png</span></code> file in the current directory. To see other options of the <code class="docutils literal notranslate"><span class="pre">81postp.py</span></code> script run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">postp</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>This outputs the following information</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>-----------------------------------------------------------------------------------------------
SYNOPSIS: solfec path/to/81postp.py path/to/file_1.thv label_1 path/to/file_2.thv label_2 [...]
No user paramters passed! Possible paramters:
-outfig path =&gt; output figure path (default: 81velo.png)
-----------------------------------------------------------------------------------------------
Paths and labels can be given in any combination, only their order matters.
For example this is also fine: solfec 81postp.py path1 path2 label1 label2.
You must first run analysis for 81array.py and then run it again print in
read mode to extract the  *.thv file.
-----------------------------------------------------------------------------------------------
</pre></div>
</div>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">-outfig</span></code> parameter to provide an alternative output path and figure format, e.g. <code class="docutils literal notranslate"><span class="pre">-outfig</span> <span class="pre">81velo.eps</span></code> would generate
a figure in the <a class="reference external" href="https://en.wikipedia.org/wiki/Encapsulated_PostScript">encapsulated postscript format</a>.</p>
</div>
<div class="section" id="running-brick-impact-test">
<h2>Running brick impact test<a class="headerlink" href="#running-brick-impact-test" title="Permalink to this headline">¶</a></h2>
<p>Run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">fbi</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">help</span>
</pre></div>
</div>
<p>to see defaults and other available parameters</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------</span>
<span class="mi">81</span> <span class="n">fuel</span> <span class="n">brick</span> <span class="n">impact</span> <span class="n">example</span> <span class="n">parameters</span><span class="p">:</span>
<span class="o">---------------------------------------------------------------------</span>
<span class="o">-</span><span class="n">form</span> <span class="n">name</span> <span class="o">=&gt;</span> <span class="n">where</span> <span class="n">name</span> <span class="ow">is</span> <span class="n">TL</span><span class="p">,</span> <span class="n">BC</span><span class="p">,</span> <span class="n">RO</span><span class="p">,</span> <span class="n">MODAL</span><span class="p">,</span> <span class="n">PR</span> <span class="ow">or</span> <span class="n">RG</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="n">BC</span><span class="p">)</span>
<span class="o">-</span><span class="n">fbmod</span> <span class="n">num</span> <span class="o">=&gt;</span> <span class="n">fuel</span> <span class="n">brick</span> <span class="n">modes</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mi">24</span><span class="p">)</span>
<span class="o">-</span><span class="n">damp</span> <span class="n">num</span> <span class="o">=&gt;</span> <span class="n">damping</span><span class="p">,</span> <span class="o">&gt;=</span> <span class="mf">0.0</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mf">1e-07</span><span class="p">)</span>
<span class="o">-</span><span class="n">step</span> <span class="n">num</span> <span class="o">=&gt;</span> <span class="n">time</span> <span class="n">step</span><span class="p">,</span> <span class="o">&gt;</span> <span class="mf">0.0</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">)</span>
<span class="o">-</span><span class="n">afile</span> <span class="n">path</span> <span class="o">=&gt;</span> <span class="n">ABAQUS</span> <span class="n">fuel</span> <span class="n">brick</span> <span class="n">impact</span> <span class="o">*.</span><span class="n">inp</span> <span class="n">file</span> <span class="n">path</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">fbi</span><span class="o">.</span><span class="n">inp</span><span class="p">)</span>
<span class="o">-</span><span class="n">rest</span> <span class="n">num</span> <span class="o">=&gt;</span> <span class="n">impact</span> <span class="n">restitution</span><span class="p">,</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">-</span><span class="n">genbase</span> <span class="o">=&gt;</span> <span class="n">generate</span> <span class="n">RO</span> <span class="n">base</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="n">same</span> <span class="k">as</span> <span class="k">for</span> <span class="mi">81</span><span class="n">array</span><span class="o">.</span><span class="n">py</span><span class="p">)</span>
<span class="o">-</span><span class="n">help</span> <span class="o">=&gt;</span> <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="ow">and</span> <span class="n">exit</span>
<span class="o">---------------------------------------------------------------------</span>
</pre></div>
</div>
<p>Run once</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">fbi</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>to generate results for a particular test (this takes from several seconds to several minutes depending on parameters).
Then run again to post–process</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">fbi</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>The last line of the printed output reads</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">For</span> <span class="n">FB</span> <span class="n">damping</span> <span class="o">=</span> <span class="mf">1e-07</span>  <span class="n">coeficient</span> <span class="n">of</span> <span class="n">restitution</span> <span class="o">=</span>  <span class="mf">0.847849288204</span>
</pre></div>
</div>
<p>Typically, this test would be used to tune the damping coefficient so that, for a fixed mesh and time step size, the experimental value
of 0.9 would be approximated. To overshoot this value a fine mesh and a small time step are required – then damping can be used to
bring the macroscopic velocity restitution down to the required level. Post–processing <code class="docutils literal notranslate"><span class="pre">81fbi.py</span></code> results also generates a figure
in the output directory, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">out</span><span class="o">/</span><span class="mi">81</span><span class="n">fbi_BC_s1</span><span class="o">.</span><span class="mf">0e-04</span><span class="n">_d1</span><span class="o">.</span><span class="mf">0e-07</span><span class="n">_r0</span><span class="o">/</span><span class="n">Brick_Velocity_Damp1e</span><span class="o">-</span><span class="mf">07.</span><span class="n">png</span>
</pre></div>
</div>
<p>included as <a class="reference internal" href="#array-fig9"><span class="std std-numref">Fig. 79</span></a> below.</p>
<div class="figure align-center" id="id25">
<span id="array-fig9"></span><a class="reference internal image-reference" href="../../_images/Brick_Velocity_Damp1e-07.png"><img alt="../../_images/Brick_Velocity_Damp1e-07.png" src="../../_images/Brick_Velocity_Damp1e-07.png" style="width: 70%;" /></a>
<p class="caption"><span class="caption-number">Fig. 79 </span><span class="caption-text">Example <a class="reference external" href="https://github.com/tkoziara/solfec/tree/master/examples/81array">81array</a>: example figure generated by post–processing <code class="docutils literal notranslate"><span class="pre">81fbi.py</span></code> results.</span></p>
</div>
<p>In this example the modal base is generate “on the fly”, hence you can simply run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">fbi</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">form</span> <span class="n">MODAL</span> <span class="o">-</span><span class="n">fbmod</span> <span class="mi">16</span>
</pre></div>
</div>
<p>and then again to post–process. The reduced order impact test by default employs the same bases as the 81array.inp input deck.
If you run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">fbi</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">form</span> <span class="n">RO</span>
</pre></div>
</div>
<p>it will “tell”</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Reading</span> <span class="n">out</span><span class="o">/</span><span class="mi">81</span><span class="n">fbi_RO_FB24_s1</span><span class="o">.</span><span class="mf">0e-04</span><span class="n">_d1</span><span class="o">.</span><span class="mf">0e-07</span><span class="n">_r0</span><span class="o">/</span><span class="n">FB1_base</span><span class="o">.</span><span class="n">pickle</span><span class="o">.</span><span class="n">gz</span> <span class="n">failed</span> <span class="o">--&gt;</span> <span class="n">you</span> <span class="n">can</span> <span class="n">run</span> <span class="o">-</span><span class="n">form</span> <span class="n">BC</span> <span class="o">-</span><span class="n">genbase</span> <span class="n">to</span> <span class="n">genrate</span> <span class="n">this</span> <span class="n">file</span>
<span class="n">Now</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">use</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">array_FB1_base</span><span class="o">.</span><span class="n">pickle</span><span class="o">.</span><span class="n">gz</span> <span class="n">instead</span> <span class="o">...</span>
</pre></div>
</div>
<p>When generating bases, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">fbi</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">genbase</span> <span class="o">-</span><span class="n">fbmod</span> <span class="mi">72</span>
</pre></div>
</div>
<p>bear in mind that the number of available modes will be less than that for the 81 array input decks –
the displacement time history is “algebraically poorer” for the impact test. This will be signalled as follows</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FB1</span><span class="p">:</span> <span class="n">calculating</span> <span class="mi">72</span> <span class="n">POD</span> <span class="n">modes</span> <span class="kn">from</span> <span class="mi">506</span> <span class="nb">input</span> <span class="n">vectors</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">432</span> <span class="o">...</span>
<span class="n">POD</span> <span class="n">generation</span> <span class="n">has</span> <span class="n">failed</span> <span class="o">--&gt;</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">possible</span> <span class="n">that</span> <span class="n">you</span> <span class="n">tried</span> <span class="n">to</span> <span class="n">extract</span> <span class="n">too</span> <span class="n">many</span> <span class="n">modes</span>
                              <span class="k">try</span> <span class="n">using</span> <span class="p">[</span><span class="o">-</span><span class="n">fbmod</span> <span class="n">a_smaller_number</span><span class="p">]</span> <span class="ow">and</span> <span class="n">re</span><span class="o">-</span><span class="n">run</span>
</pre></div>
</div>
<p>You can then reuse the existing results and just keep trying, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">fbi</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">genbase</span> <span class="o">-</span><span class="n">fbmod</span> <span class="mi">32</span>
</pre></div>
</div>
<p>will work. You can than run the reduced order analysis</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solfec</span> <span class="n">examples</span><span class="o">/</span><span class="mi">81</span><span class="n">array</span><span class="o">/</span><span class="mi">81</span><span class="n">fbi</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">form</span> <span class="n">RO</span> <span class="o">-</span><span class="n">fbmod</span> <span class="mi">32</span>
</pre></div>
</div>
<p>and post–process it (re–run again) to find out the restitution coefficient.</p>
<table class="docutils footnote" frame="void" id="id10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[*]</a></td><td>AGR stands for an <a class="reference external" href="https://en.wikipedia.org/wiki/Advanced_gas-cooled_reactor">Advanced Gass-cooled Reactor</a>.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id11" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[1]</a></td><td><a class="reference external" href="http://onlinelibrary.wiley.com/doi/10.1002/eqe.4290150203/abstract">Ahmed, Khalid and Stojko, Stefan, “The non–linear seismic response of AGR core graphite brick slices
– correlation of experimental and analytical results”, Earthquake Engineering &amp; Structural Dynamics (1987), 159–188.</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[2]</a></td><td><a class="reference external" href="http://www.sciencedirect.com/science/article/pii/0029549387903037">Ahmed, K. M., “The dynamic response of multi-layers AGR core brick arrays”, Nuclear Engineering and Design (1987),
1–66.</a></td></tr>
</tbody>
</table>
</div>
</div>

  <div class="section">
  
  
  </div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">PARMES</a></h1>



<p class="blurb">Parallel mechanics and particulate media software blog</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=parmes&repo=parmes&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">SOLFEC</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../running.html">Running</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user.html">User Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory.html">Theory Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../validation.html">Validation Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../xdmf.html">XDMF export</a></li>
<li class="toctree-l2"><a class="reference internal" href="../applications.html">Applications</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="hybrid_modeling.html">Hybrid modeling</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="reduced_order.html">Reduced order modeling</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="reduced_order/ro0.html">Rotating bar</a></li>
<li class="toctree-l4"><a class="reference internal" href="reduced_order/ro1.html">Pipe impact</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">81 bricks array</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#running-81-array">Running 81 array</a></li>
<li class="toctree-l5"><a class="reference internal" href="#post-processing-81-array">Post–processing 81 array</a></li>
<li class="toctree-l5"><a class="reference internal" href="#running-brick-impact-test">Running brick impact test</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="time_series.html">Time series</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../dynlb/index.html">DYNLB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parmec/index.html">PARMEC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vbox/index.html">VBOX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tgz/index.html">TGZ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trs/index.html">TRs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../groups.html">Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference external" href="https://liberapay.com/Tomek/">Liberpay</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">SOLFEC</a><ul>
  <li><a href="../examples.html">Solfec Examples</a><ul>
  <li><a href="reduced_order.html">Reduced order modeling</a><ul>
      <li>Previous: <a href="reduced_order/ro1.html" title="previous chapter">Pipe impact</a></li>
      <li>Next: <a href="time_series.html" title="next chapter">Time series</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../../blog.html">Recent Posts</a></h3>
  <ul>
    
    
      <li><a href="../../blog/parmec_ball_joint.html">31 July - Parmec ball joint and articulated pendulum example</a></li>
    
      <li><a href="../../blog/parmec_spherical_joint.html">13 June - Parmec spherical joint</a></li>
    
      <li><a href="../../blog/parmec_spring_contact.html">23 May - Parmec spring contact</a></li>
    
      <li><a href="../../blog/spring_curve_tests.html">07 March - Parmec spring curve tests</a></li>
    
      <li><a href="../../blog/unspring_and_spring_state.html">15 January - UNSPRING and spring state in Parmec</a></li>
    
  </ul>

  <h3><a href="../../blog/tag.html">Tags</a></h3>
  <style type="text/css">
    ul.ablog-cloud {list-style: none; overflow: auto;}
    ul.ablog-cloud li {float: left; height: 20pt; line-height: 18pt; margin-right: 5px;}
    ul.ablog-cloud a {text-decoration: none; vertical-align: middle;}
    li.ablog-cloud-1{font-size: 80%;}
    li.ablog-cloud-2{font-size: 95%;}
    li.ablog-cloud-3{font-size: 110%;}
    li.ablog-cloud-4{font-size: 125%;}
    li.ablog-cloud-5{font-size: 140%;}
  </style>
  <ul class="ablog-cloud">
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/algebraic.html">algebraic</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/contact.html">contact</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/failure.html">failure</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/friction.html">friction</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/joints.html">joints</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/optimization.html">optimization</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-5">
        <a href="../../blog/tag/parmec.html">parmec</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/parmes.html">parmes</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/pendulum.html">pendulum</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/performance.html">performance</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/reports.html">reports</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../../blog/tag/solfec.html">solfec</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/springs.html">springs</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-2">
        <a href="../../blog/tag/tests.html">tests</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/torsion.html">torsion</a></li>
      
    
  </ul>

  <h3><a href="../../blog/archive.html">Archives</a></h3>
  <ul>
  
    
    <li><a href="../../blog/2018.html">2018 (5)</a></li>
    
  
    
    <li><a href="../../blog/2017.html">2017 (4)</a></li>
    
  
    
    <li><a href="../../blog/2016.html">2016 (1)</a></li>
    
  
  </ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018 PARMES team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.9</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="../../_sources/solfec/examples/81array.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>