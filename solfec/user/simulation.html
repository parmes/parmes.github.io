
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Simulation &#8212; PARMES  documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/parmes.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Fragmentation" href="fragmentation.html" />
    <link rel="prev" title="Solvers" href="solvers.html" />
  
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  
  <link rel="alternate" type="application/atom+xml"  href="../../blog/atom.xml" title="PARMES/blog">
  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="simulation">
<span id="solfec-user-simulation"></span><h1>Simulation<a class="headerlink" href="#simulation" title="Permalink to this headline">¶</a></h1>
<p>Routines listed in this section control the solution process.
A simulation can be run be invoking the RUN command, documented below.</p>
<div class="topic" id="solfec-command-run">
<p class="topic-title first">RUN (solfec, solver, duration)</p>
<p>This routine runs a simulation.</p>
<ul class="simple">
<li>solfec – SOLFEC object</li>
<li>solver – constraint solver object (e.g. GAUSS_SEIDEL_SOLVER, NEWTON_SOLVER, PENALTY_SOLVER)</li>
<li>duration – duration of analysis. <em>Note:</em> this parameter is ignored when an analysis is run in the viewer mode (with –v switch).</li>
</ul>
</div>
<div class="section" id="initialization">
<h2>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h2>
<p>Prior to running, a simulation may also require initialization.
Below we list subroutines providing per–body or per–simulation initialization functionality.</p>
<div class="topic">
<p class="topic-title first">INITIAL_VELOCITY (body, linear, angular)</p>
<p>This routine applies initial (at time zero) linear and angular (in the sense of rigid motion) velocity to a body.</p>
<ul class="simple">
<li>body – BODY object</li>
<li>linear – linear velocity <span class="math">\((v_{x},v_{y},v_{z})\)</span></li>
<li>angular – angular velocity <span class="math">\((\omega_{x},\omega_{y},\omega_{z} )\)</span></li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">INITIALIZE_STATE (solfec, path, time | subset)</p>
<p>This routine initializes the state of a Solfec object with the state red from an output
directory at a given time. It is ignored in the ‘READ’ mode. <em>Note</em>: constraint reactions
are initialized with zeros and recalculated at the next time step.</p>
<ul class="simple">
<li>solfec – Solfec object in the ‘WRITE’ mode</li>
<li>path – path to the output directory containing matching analysis results (note: this cannot be the same output directory as for the solfec object)</li>
<li>time – time at which the state should be red from the output files</li>
<li>subset – defines a subset of initialized bodies; a string can be used to define a POSIX regular expression <a class="footnote-reference" href="#id3" id="id1">[1]</a> that will be matched against body labels;
a list of such strings can also be passed; e.g. [‘^BOD.*A$’, ‘^BODY1$’, ‘^BODY2$’, ‘^BOD.*B$’] defines two direct labels ‘BODY1’ and ‘BODY2’ and two
possible subsets made of labels such as ‘BODY123A’, ‘BODY_anything_B’, etc.</li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">RIGID_TO_FEM (path, time, solfec | subset)</p>
<p>This routine initializes the state of FEM bodies within the Solfec object with the state of rigid bodies
red from an output directory at a given time. It is ignored in the ‘READ’ mode. <em>Note:</em> rigid displacements
are applied to the finite element bodies; this implies that when you add boundary conditions to finite element
bodies, after their state was updated with RIGID_TO_FEM, you still use the original referential point coordinates
as the locations of the constraints (e.g. when using SET_DISPLACEMENT or SET_VELOCITY).</p>
<ul class="simple">
<li>path – path to the output directory containing matching rigid body analysis results;
the number of rigid bodies in this analysis must match the number of FEM bodies in the Solfec object;
the identifiers of rigid bodies must match the identifiers of FEM bodies;
this is guaranteed if the input files for both analyses differ only by the prescribed body kinds;</li>
<li>time – time at which the state should be red from the output files</li>
<li>solfec – Solfec object in the ‘WRITE’ mode</li>
<li>subset – defines a subset of initialized bodies; a string can be used to define a POSIX regular expression <a class="footnote-reference" href="#id3" id="id2">[1]</a> that will be matched against body labels;
a list of such strings can also be passed; e.g. [‘^BOD.*A$’, ‘^BODY1$’, ‘^BODY2$’, ‘^BOD.*B$’] defines two direct labels ‘BODY1’ and ‘BODY2’ and two
possible subsets made of labels such as ‘BODY123A’, ‘BODY_anything_B’, etc.</li>
</ul>
</div>
</div>
<div class="section" id="runtime-utilities">
<h2>Runtime utilities<a class="headerlink" href="#runtime-utilities" title="Permalink to this headline">¶</a></h2>
<p>Routines below help control runtime behaviour.</p>
<div class="topic" id="solfec-command-output">
<p class="topic-title first">OUTPUT (solfec, interval | compression)</p>
<p>This routine specifies the frequency of writing to the output file.</p>
<ul class="simple">
<li>solfec – SOLFEC object</li>
<li>interval – length of the time interval elapsing before consecutive output file writes</li>
<li>compression – output compression mode: ‘OFF’ (default) or ‘ON’.
Compressed output files are smaller, although they might not be portable between hardware platforms.</li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">EXTENTS (solfec, extents)</p>
<p>This routine bounds the simulation space. Bodies falling outside of the extents are deleted from the simulation.</p>
<ul class="simple">
<li>solfec – SOLFEC object</li>
<li>extents – (xmin, ymin, zmin, xmax, ymax, zmax) tuple</li>
</ul>
</div>
<div class="topic" id="solfec-command-callback">
<p class="topic-title first">CALLBACK (solfec, interval, data, callback)</p>
<p>This routine defines a callback function, invoked during a run of Solfec every interval of time.
A callback routine can interrupt the course of RUN command by returning 0.</p>
<ul class="simple">
<li>solfec – SOLFEC object</li>
<li>interval – length of the time interval elapsing before consecutive callback calls</li>
<li>data – data passed to the callback function</li>
<li>callback – callback function of form: value = callback (data), where for the returned value equal zero Solfec run is stopped</li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">WARNINGS (state)</p>
<p>This routine disables or enables Solfec warnings. It is a good practice to have the
warnings enabled and only switch them off after making sure, that they can be ignored.</p>
<ul class="simple">
<li>state – ‘ON’ or ‘OFF’ (default: ‘ON’)</li>
</ul>
</div>
</div>
<div class="section" id="contact-handling">
<h2>Contact handling<a class="headerlink" href="#contact-handling" title="Permalink to this headline">¶</a></h2>
<p>Routines listed below affect contact detection and contact handling.</p>
<div class="topic" id="solfec-command-geometric-epsilon">
<p class="topic-title first">GEOMETRIC_EPSILON (epsilon)</p>
<p>This routine sets a numerical tolerance for geometric tests performed within Solfec.
The tolerance is a characteristic distance between two distinct points below which they can be regarded as one.
See also <a class="reference internal" href="../theory/conpnt.html#geometric-epsilon-section"><span class="std std-ref">this comment</span></a> in the <a class="reference internal" href="../theory.html#solfec-theory"><span class="std std-ref">Theory Manual</span></a>.</p>
<ul class="simple">
<li>epsilon – geometrical tolerance (default: 1E-6)</li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">UNPHYSICAL_PENETRATION (solfec, depth)</p>
<p>This routine sets a depth of allowed an unphysical interpenetration.
Once it is exceeded, the simulation is stopped and a suitable error message printed out.</p>
<ul class="simple">
<li>solfec – SOLFEC object</li>
<li>depth – interpenetration depth bound (default: <span class="math">\(\infty\)</span>)</li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">CONTACT_EXCLUDE_BODIES (body1, body2)</p>
<p>This routine disables contact detection for a specific pair of bodies. By default contact detection
is enabled for all possible body pairs. <em>Note:</em> must be invoked on all processors during a parallel
run (do not use from within a callback).</p>
<ul class="simple">
<li>body1 – first BODY object</li>
<li>body2 – second BODY object</li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">CONTACT_EXCLUDE_SURFACES (solfec, surf1, surf2)</p>
<p>This routine disables contact detection for a specific pair of surfaces. By default contact detection
is enabled for all possible surface pairs. <em>Note:</em> must be invoked on all processors during a parallel
run (do not use from within a callback).</p>
<ul class="simple">
<li>solfec – SOLFEC object</li>
<li>surf1 – first BODY object</li>
<li>surf2 – second BODY object</li>
</ul>
</div>
<div class="topic" id="solfec-command-contact-sparsify">
<p class="topic-title first">CONTACT_SPARSIFY (solfec | threshold, minarea, mindist)</p>
<p>This routine modifies contact filtering (sparsification) behaviour. Generally speaking, some contact points
are filtered out in order to avoid unnecessary dense contact point clusters. If a pair of bodies is connected
by two or more contact points, one of the points generated by topologically adjacent entities (elements,
convices) will be removed (sparsified) if the ratio of contact areas of the contact points is smaller than
the prescribed threshold. See also <a class="reference internal" href="../theory/conpnt.html#contact-sparsification"><span class="std std-ref">contact sparsification</span></a>.</p>
<ul class="simple">
<li>solfec – SOLFEC object</li>
<li>threshold – sparsification threshold (default: 0.01) from within the interval [0, 1]. Zero corresponds to the lack of sparsification.</li>
<li>minarea – minimal contact area (default: 0.0). Contact points with area smaller then minarea are dropped.</li>
<li>mindist – minimal distance between distinct contact points (default: GEOMETRIC_EPSILON).</li>
</ul>
</div>
</div>
<div class="section" id="parallel-runtime">
<h2>Parallel runtime<a class="headerlink" href="#parallel-runtime" title="Permalink to this headline">¶</a></h2>
<p>Routines listed below are related to prallel runtime and performance.</p>
<div class="topic">
<p class="topic-title first">IMBALANCE_TOLERANCE (solfec, tolerance | weightfactor, updatefreq)</p>
<p>This routine sets the imbalance tolerance for parallel balancing of Solfec data. A ratio of maximal to minimal
per processor count of objects used. Hence, 1.0 indicates perfect balance, while any ratio &gt; 1.0 indicates an
imbalance. Initially imbalance tolerance is set to 1.1. This routine is ignored during sequential runs.</p>
<ul class="simple">
<li>solfec – SOLFEC object</li>
<li>tolerance – data imbalance tolerance (default: 1.1)</li>
</ul>
<ul class="simple">
<li>weightfactor – a local dynamics weight factor between 0.0 and 1.0 (default: 1.0). Computational load of
local dynamics assembling is best balanced when weightfactor equals 1.0. This however can sometimes result
in a poor load balance for contact detection or time integration. Making it smaller than 1.0 can improve
the overall balance in such cases.
<em>Note:</em> This parameter is ignored if DYNLB load balancer is used; in this case, on a per-rank basis, body
centroids are used to guide load balancing if there is more bodies than constrains on a given rank at
given time; otherwise contact/constraint points are used to guide load balancing.</li>
</ul>
<ul class="simple">
<li>updatefreq – geometrical domain partitioning is updated every updatefreq time steps (default: 10)</li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">num = RANK ()</p>
<p>This routine returns the rank of the CPU that runs the current copy of Solfec.</p>
<ul class="simple">
<li>num – the CPU rank</li>
</ul>
</div>
<div class="topic">
<p class="topic-title first">BARRIER ()</p>
<p>This routine sets up a parallel barrier in the MPI mode (all processes need to
meet at it before they can continue). It is ignored in the serial mode.</p>
</div>
<div class="topic">
<p class="topic-title first">num = NCPU (| solfec)</p>
<p>This routine returns the number CPUs used in the analysis.</p>
<ul class="simple">
<li>num – the number of CPUs</li>
<li>solfec – optional SOLFEC object (useful in ‘READ’ mode)</li>
</ul>
</div>
<div class="topic" id="solfec-command-here">
<p class="topic-title first">ret = HERE (solfec, object)</p>
<p>This routine tests whether an object is located on the current processor. During parallel runs
objects migrate between processors. When calling a function (or a member) for an object not present
on the current processor, the call will usually return None or be ignored. Hence, it is convenient
to check whether an object resides on the current processor.</p>
<ul class="simple">
<li>ret – True or False</li>
<li>solfec – SOLFEC object</li>
<li>object – BODY or CONSTRAINT object</li>
</ul>
</div>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> <a class="reference external" href="https://en.wikibooks.org/wiki/Regular_Expressions/POSIX_Basic_Regular_Expressions">POSIX regular expressions</a></td></tr>
</tbody>
</table>
</div>
</div>

  <div class="section">
  
  
  </div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">PARMES</a></h1>



<p class="blurb">Parallel mechanics and particulate media software blog</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=parmes&repo=parmes&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">SOLFEC</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../running.html">Running</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../user.html">User Manual</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="solfec.html">SOLFEC object</a></li>
<li class="toctree-l3"><a class="reference internal" href="body.html">BODY object</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry.html">Geometry</a></li>
<li class="toctree-l3"><a class="reference internal" href="materials.html">Materials</a></li>
<li class="toctree-l3"><a class="reference internal" href="times.html">Time series</a></li>
<li class="toctree-l3"><a class="reference internal" href="loads.html">Loads</a></li>
<li class="toctree-l3"><a class="reference internal" href="constraints.html">Constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="solvers.html">Solvers</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Simulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#initialization">Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#runtime-utilities">Runtime utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="#contact-handling">Contact handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parallel-runtime">Parallel runtime</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fragmentation.html">Fragmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="results.html">Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../theory.html">Theory Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../validation.html">Validation Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../xdmf.html">XDMF export</a></li>
<li class="toctree-l2"><a class="reference internal" href="../applications.html">Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../dynlb/index.html">DYNLB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parmec/index.html">PARMEC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vbox/index.html">VBOX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tgz/index.html">TGZ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trs/index.html">TRs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../patreon.html">Patreon</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">SOLFEC</a><ul>
  <li><a href="../user.html">Solfec User Manual</a><ul>
      <li>Previous: <a href="solvers.html" title="previous chapter">Solvers</a></li>
      <li>Next: <a href="fragmentation.html" title="next chapter">Fragmentation</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../../blog.html">Recent Posts</a></h3>
  <ul>
    
    
      <li><a href="../../blog/cached_time_series.html">Aug 01 - Partially cached time series in Solfec</a></li>
    
      <li><a href="../../blog/tr1_post.html">May 20 - TR1: Co-rotated and reduced order time integrators</a></li>
    
      <li><a href="../../blog/hybrid_solver.html">Apr 27 - Hybrid solver in Solfec</a></li>
    
      <li><a href="../../blog/about.html">Jun 13 - About PARMES</a></li>
    
  </ul>

  <h3><a href="../../blog/tag.html">Tags</a></h3>
  <style type="text/css">
    ul.ablog-cloud {list-style: none; overflow: auto;}
    ul.ablog-cloud li {float: left; height: 20pt; line-height: 18pt; margin-right: 5px;}
    ul.ablog-cloud a {text-decoration: none; vertical-align: middle;}
    li.ablog-cloud-1{font-size: 80%;}
    li.ablog-cloud-2{font-size: 95%;}
    li.ablog-cloud-3{font-size: 110%;}
    li.ablog-cloud-4{font-size: 125%;}
    li.ablog-cloud-5{font-size: 140%;}
  </style>
  <ul class="ablog-cloud">
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/parmec.html">parmec</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/parmes.html">parmes</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../../blog/tag/reports.html">reports</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-5">
        <a href="../../blog/tag/solfec.html">solfec</a></li>
      
    
  </ul>

  <h3><a href="../../blog/archive.html">Archives</a></h3>
  <ul>
  
    
    <li><a href="../../blog/2017.html">2017 (3)</a></li>
    
  
    
    <li><a href="../../blog/2016.html">2016 (1)</a></li>
    
  
  </ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017 PARMES team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../../_sources/solfec/user/simulation.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>